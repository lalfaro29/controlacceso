CREATE TABLE asistencia.Cargo (idcargo SERIAL, cargo VARCHAR(70) NOT NULL, PRIMARY KEY(idcargo));
CREATE TABLE asistencia.Configuracion (idconfiguracion SERIAL, idusuario INT, fecha TIMESTAMP NOT NULL, horaentrada TIME NOT NULL, horasalida TIME NOT NULL, horamaxentrada INT NOT NULL, central SMALLINT DEFAULT 0 NOT NULL, cestatique_x_jornada FLOAT DEFAULT 0 NOT NULL, precioticks FLOAT, idsede INT NOT NULL, horadesdedi TIME NOT NULL, horahastadi TIME NOT NULL, horadesdeno TIME NOT NULL, horahastano TIME NOT NULL, porcentajedi FLOAT DEFAULT 0 NOT NULL, porcentajeno FLOAT DEFAULT 0 NOT NULL, PRIMARY KEY(idconfiguracion));
CREATE TABLE asistencia.coordinador (id BIGSERIAL, usuario_id INT NOT NULL, departamento_id INT NOT NULL, PRIMARY KEY(id));
CREATE TABLE asistencia.Departamento (iddepartamento SERIAL, departamento VARCHAR(60) NOT NULL, PRIMARY KEY(iddepartamento));
CREATE TABLE asistencia.Feriado (idferiado BIGSERIAL, feriado VARCHAR(200) NOT NULL, feriadofechdesde DATE NOT NULL, feriadofechhasta DATE, feriadohoradesde TIME NOT NULL, feriadohorahasta TIME NOT NULL, porcentajeferiado FLOAT NOT NULL, porcentajenocturno FLOAT NOT NULL, un_dia BOOLEAN DEFAULT 'true' NOT NULL, tomar_anio BOOLEAN DEFAULT 'true' NOT NULL, PRIMARY KEY(idferiado));
CREATE TABLE asistencia.jefe_unidad (id BIGSERIAL, usuario_id INT NOT NULL, departamento_id INT NOT NULL, PRIMARY KEY(id));
CREATE TABLE asistencia.Motivo (idmotivo BIGSERIAL, motivo VARCHAR(100) NOT NULL, activo BOOLEAN DEFAULT 'true' NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP NOT NULL, PRIMARY KEY(idmotivo));
CREATE TABLE asistencia.Movimiento (idmovimiento SERIAL, idusuario INT NOT NULL, fecha TIMESTAMP NOT NULL, movimiento VARCHAR(1) NOT NULL, estado VARCHAR(10) DEFAULT 'PUNTUAL' NOT NULL, registro VARCHAR(15) NOT NULL, ipsede VARCHAR(30) DEFAULT '------', ipusuario VARCHAR(30) DEFAULT '------', idconfiguracion INT, idmotivo INT, PRIMARY KEY(idmovimiento));
CREATE TABLE asistencia.Permiso (idpermiso SERIAL, usuario_id INT, fecha TIMESTAMP NOT NULL, fechadesde TIMESTAMP NOT NULL, fechahasta TIMESTAMP NOT NULL, horas INT DEFAULT 0 NOT NULL, tipopermiso VARCHAR(10) DEFAULT 'un dia' NOT NULL, idmotivo INT NOT NULL, archivo VARCHAR(100), PRIMARY KEY(idpermiso));
CREATE TABLE asistencia.proyecto (idproyecto SERIAL, proyecto VARCHAR(50) NOT NULL, PRIMARY KEY(idproyecto));
CREATE TABLE asistencia.RelacionConfigFeriado (idconfiguracion BIGINT, idferiado BIGINT, PRIMARY KEY(idconfiguracion, idferiado));
CREATE TABLE asistencia.Sede (idsede SERIAL, sede VARCHAR(50) NOT NULL, activa SMALLINT DEFAULT 1 NOT NULL, PRIMARY KEY(idsede));
CREATE TABLE asistencia.tipoEmpleado (idtipoempleado SERIAL, empleado VARCHAR(45) NOT NULL, PRIMARY KEY(idtipoempleado));
CREATE TABLE asistencia.TipoUsuario (idtipousuario SERIAL, tipousuario VARCHAR(50) NOT NULL, PRIMARY KEY(idtipousuario));
CREATE TABLE asistencia.Usuario (idusuario SERIAL, nombre VARCHAR(50) NOT NULL, apellido VARCHAR(50) NOT NULL, cedula VARCHAR(15) NOT NULL, idtipoempleado INT NOT NULL, idcargo INT NOT NULL, iddepartamento INT NOT NULL, idsede INT NOT NULL, estado INT DEFAULT 1 NOT NULL, fechaingreso TIMESTAMP NOT NULL, sueldo FLOAT DEFAULT 0 NOT NULL, idproyecto INT NOT NULL, idconfiguracion INT NOT NULL, ipusuario VARCHAR(30), activo CHAR(1) DEFAULT 'S' NOT NULL, PRIMARY KEY(idusuario));
CREATE TABLE asistencia.UsuarioSistema (idusuariosistema SERIAL, idtipousuario INT DEFAULT 1 NOT NULL, idusuario INT NOT NULL, psw VARCHAR(50) NOT NULL, PRIMARY KEY(idusuariosistema));
ALTER TABLE asistencia.Configuracion ADD CONSTRAINT asistencia_Configuracion_idusuario_asistencia_Usuario_idusuario FOREIGN KEY (idusuario) REFERENCES asistencia.Usuario(idusuario) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Configuracion ADD CONSTRAINT asistencia_Configuracion_idsede_asistencia_Sede_idsede FOREIGN KEY (idsede) REFERENCES asistencia.Sede(idsede) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.coordinador ADD CONSTRAINT asistencia_coordinador_usuario_id_asistencia_Usuario_idusuario FOREIGN KEY (usuario_id) REFERENCES asistencia.Usuario(idusuario) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.coordinador ADD CONSTRAINT adai FOREIGN KEY (departamento_id) REFERENCES asistencia.Departamento(iddepartamento) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.jefe_unidad ADD CONSTRAINT asistencia_jefe_unidad_usuario_id_asistencia_Usuario_idusuario FOREIGN KEY (usuario_id) REFERENCES asistencia.Usuario(idusuario) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.jefe_unidad ADD CONSTRAINT adai_1 FOREIGN KEY (departamento_id) REFERENCES asistencia.Departamento(iddepartamento) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Movimiento ADD CONSTRAINT asistencia_Movimiento_idusuario_asistencia_Usuario_idusuario FOREIGN KEY (idusuario) REFERENCES asistencia.Usuario(idusuario) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Movimiento ADD CONSTRAINT asistencia_Movimiento_idmotivo_asistencia_Motivo_idmotivo FOREIGN KEY (idmotivo) REFERENCES asistencia.Motivo(idmotivo) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Movimiento ADD CONSTRAINT aiai_4 FOREIGN KEY (idconfiguracion) REFERENCES asistencia.Configuracion(idconfiguracion) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Permiso ADD CONSTRAINT asistencia_Permiso_usuario_id_asistencia_Usuario_idusuario FOREIGN KEY (usuario_id) REFERENCES asistencia.Usuario(idusuario) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Permiso ADD CONSTRAINT asistencia_Permiso_idmotivo_asistencia_Motivo_idmotivo FOREIGN KEY (idmotivo) REFERENCES asistencia.Motivo(idmotivo) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.RelacionConfigFeriado ADD CONSTRAINT aiai_6 FOREIGN KEY (idferiado) REFERENCES asistencia.Feriado(idferiado) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.RelacionConfigFeriado ADD CONSTRAINT aiai_5 FOREIGN KEY (idconfiguracion) REFERENCES asistencia.Configuracion(idconfiguracion) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Usuario ADD CONSTRAINT asistencia_Usuario_idsede_asistencia_Sede_idsede FOREIGN KEY (idsede) REFERENCES asistencia.Sede(idsede) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Usuario ADD CONSTRAINT asistencia_Usuario_idproyecto_asistencia_proyecto_idproyecto FOREIGN KEY (idproyecto) REFERENCES asistencia.proyecto(idproyecto) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Usuario ADD CONSTRAINT asistencia_Usuario_idcargo_asistencia_Cargo_idcargo FOREIGN KEY (idcargo) REFERENCES asistencia.Cargo(idcargo) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Usuario ADD CONSTRAINT aiai_9 FOREIGN KEY (idtipoempleado) REFERENCES asistencia.tipoEmpleado(idtipoempleado) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Usuario ADD CONSTRAINT aiai_11 FOREIGN KEY (idconfiguracion) REFERENCES asistencia.Configuracion(idconfiguracion) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.Usuario ADD CONSTRAINT aiai_10 FOREIGN KEY (iddepartamento) REFERENCES asistencia.Departamento(iddepartamento) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.UsuarioSistema ADD CONSTRAINT asistencia_UsuarioSistema_idusuario_asistencia_Usuario_idusuario FOREIGN KEY (idusuario) REFERENCES asistencia.Usuario(idusuario) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE asistencia.UsuarioSistema ADD CONSTRAINT aiai_12 FOREIGN KEY (idtipousuario) REFERENCES asistencia.TipoUsuario(idtipousuario) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
